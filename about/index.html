<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û –Ω–∞—Å | Minecraft Wiki</title>
    <style>
        /* –í—Å–µ —Å—Ç–∏–ª–∏ –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –æ—Å—Ç–∞—é—Ç—Å—è */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', Arial, sans-serif;
        }

        body {
            background-color: #0f0f0f;
            color: #f1f1f1;
            padding-top: 62px;
        }

        /* –®–∞–ø–∫–∞ */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 22px;
            height: 62px;
            background-color: #0f0f0f;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            border-bottom: 1px solid #272727;
        }

        .left-section {
            display: flex;
            align-items: center;
        }

        .logo-container {
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .logo-icon {
            color: #fff;
            margin-right: 22px;
            font-size: 21px;
            background: #272727;
            width: 38px;
            height: 38px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .auth-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .login-button {
            background: #065fd4;
            color: white;
            border: none;
            border-radius: 18px;
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.3s;
        }

        .login-button:hover {
            background: #0f4db3;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            background: #272727;
            padding: 6px 12px;
            border-radius: 18px;
        }

        .user-avatar-small {
            width: 28px;
            height: 28px;
            border-radius: 50%;
        }

        .user-avatar {
            width: 34px;
            height: 34px;
            border-radius: 11px;
            cursor: pointer;
            border: 2px solid #333;
        }

        /* –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å */
        .sidebar {
            position: fixed;
            top: 62px;
            left: 0;
            bottom: 0;
            width: 230px;
            background-color: #0f0f0f;
            padding-top: 14px;
            overflow-y: auto;
            z-index: 99;
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            padding: 0 22px;
            height: 42px;
            cursor: pointer;
            font-size: 14px;
            border-radius: 11px;
            margin: 0 11px;
            transition: background-color 0.2s;
        }

        .sidebar-item:hover {
            background-color: #272727;
        }

        .sidebar-item.active {
            background-color: #272727;
            font-weight: 500;
        }

        .sidebar-icon {
            margin-right: 22px;
            font-size: 19px;
        }

        .sidebar-divider {
            height: 1px;
            background-color: #272727;
            margin: 14px 11px;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
        main {
            margin-left: 230px;
            padding: 22px 44px;
            max-width: 1350px;
            margin-right: auto;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 22px;
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
            color: #fff;
        }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç Tilda */
        .tilda-content {
            background: #1a1a1a;
            border-radius: 12px;
            padding: 30px;
            margin-top: 20px;
        }

        .tilda-content iframe {
            width: 100%;
            height: 800px;
            border: none;
            border-radius: 8px;
        }

        .loading-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            color: #aaa;
            font-size: 16px;
        }

        .loading-spinner {
            width: 20px;
            height: 20px;
            border: 2px solid #333;
            border-top: 2px solid #065fd4;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- –®–∞–ø–∫–∞ -->
    <header>
        <div class="left-section">
            <div class="logo-container" onclick="showMainPage()">
                <div class="logo-icon">‚â°</div>
                <div style="color: white; font-size: 21px; font-weight: bold;">Bunker Show</div>
            </div>
        </div>

        <div class="right-section">
            <div class="auth-section" id="authSection">
                <button class="login-button" onclick="handleAuthClick()" id="loginButton" style="visibility: hidden;">–í–æ–π—Ç–∏</button>
            </div>
            <img src="https://yt3.googleusercontent.com/b1QWqjw9-5jaqxtoeGUnMtwKD01lruTvlDT9XkcVh41F9bCnxMt0Il3iI3s9AURp6XfpI3in4g=s160-c-k-c0x00ffffff-no-rj" alt="–ê–≤–∞—Ç–∞—Ä" class="user-avatar">
        </div>
    </header>

    <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
    <aside class="sidebar">
        <div class="sidebar-item" onclick="showMainPage()">
            <div class="sidebar-icon">üè†</div>
            <span>–ì–ª–∞–≤–Ω–∞—è</span>
        </div>
        <div class="sidebar-item">
            <div class="sidebar-icon">üî•</div>
            <span>Shorts</span>
        </div>
        <div class="sidebar-item">
            <div class="sidebar-icon">üì∫</div>
            <span>–ü–æ–¥–ø–∏—Å–∫–∏</span>
        </div>
        
        <div class="sidebar-divider"></div>
        
        <div class="sidebar-item">
            <div class="sidebar-icon">üìö</div>
            <span>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞</span>
        </div>
        <div class="sidebar-item">
            <div class="sidebar-icon">üìú</div>
            <span>–ò—Å—Ç–æ—Ä–∏—è</span>
        </div>
        
        <div class="sidebar-divider"></div>
        
        <div class="sidebar-item active">
            <div class="sidebar-icon">üë•</div>
            <span>–û –Ω–∞—Å</span>
        </div>
        <div class="sidebar-item" onclick="showMapsPage()">
            <div class="sidebar-icon">üó∫Ô∏è</div>
            <span>–ö–∞—Ä—Ç—ã</span>
        </div>
        <div class="sidebar-item">
            <div class="sidebar-icon">üìÇ</div>
            <span>–ü–æ–¥–±–æ—Ä–∫–∏</span>
        </div>
    </aside>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main>
        <div class="page-header">
            <h1 class="page-title">–û –Ω–∞—Å</h1>
        </div>

        <div class="tilda-content">
            <div class="loading-container" id="loadingContent">
                <div class="loading-spinner"></div>
                <span>–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞...</span>
            </div>
            <iframe id="tildaFrame" src="https://deynik.tilda.ws/" style="display: none;" onload="hideLoader()"></iframe>
        </div>
    </main>

    <script>
        // === –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –° –í–ê–®–ò–ú–ò –ö–õ–Æ–ß–ê–ú–ò ===
        const CLIENT_ID = '591207353726-shbp5qq759sf9qo0stpmt0d8i0ff432l.apps.googleusercontent.com';
        const API_KEY = 'AIzaSyCmhhCOveZ5GRDSjBEv8MJMENml_AEh_Aw';
        const DISCOVERY_DOC = 'https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest';
        const SCOPES = 'https://www.googleapis.com/auth/youtube.force-ssl';

        let tokenClient;
        let gapiInited = false;
        let gisInited = false;

        // === –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø GOOGLE API ===
        function gapiLoaded() {
            gapi.load('client', initializeGapiClient);
        }

        async function initializeGapiClient() {
            await gapi.client.init({
                apiKey: API_KEY,
                discoveryDocs: [DISCOVERY_DOC],
            });
            gapiInited = true;
            maybeEnableButtons();
        }

        function gisLoaded() {
            tokenClient = google.accounts.oauth2.initTokenClient({
                client_id: CLIENT_ID,
                scope: SCOPES,
                callback: '', // –æ–ø—Ä–µ–¥–µ–ª–∏–º –ø–æ–∑–∂–µ
            });
            gisInited = true;
            maybeEnableButtons();
        }

        function maybeEnableButtons() {
            if (gapiInited && gisInited) {
                document.getElementById('loginButton').style.visibility = 'visible';
            }
        }

        // === –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø ===
        function handleAuthClick() {
            tokenClient.callback = async (resp) => {
                if (resp.error !== undefined) {
                    console.error('Auth error:', resp);
                    alert('–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: ' + resp.error);
                    return;
                }
                await updateUI();
            };

            if (gapi.client.getToken() === null) {
                tokenClient.requestAccessToken({prompt: 'consent'});
            } else {
                tokenClient.requestAccessToken({prompt: ''});
            }
        }

        function handleSignoutClick() {
            const token = gapi.client.getToken();
            if (token !== null) {
                google.accounts.oauth2.revoke(token.access_token);
                gapi.client.setToken('');
                updateUI();
                location.reload();
            }
        }

        // === –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê ===
        async function updateUI() {
            const isSignedIn = gapi.client.getToken() !== null;
            
            if (isSignedIn) {
                try {
                    const userInfo = await gapi.client.youtube.channels.list({
                        part: 'snippet',
                        mine: true
                    });
                    
                    if (userInfo.result.items && userInfo.result.items.length > 0) {
                        const user = userInfo.result.items[0].snippet;
                        document.getElementById('authSection').innerHTML = `
                            <div class="user-info">
                                <img src="${user.thumbnails.default.url}" alt="${user.title}" class="user-avatar-small">
                                <span>${user.title}</span>
                                <button class="login-button" onclick="handleSignoutClick()">–í—ã–π—Ç–∏</button>
                            </div>
                        `;
                    }
                } catch (error) {
                    console.error('Error getting user info:', error);
                    document.getElementById('authSection').innerHTML = `
                        <div class="user-info">
                            <span>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
                            <button class="login-button" onclick="handleSignoutClick()">–í—ã–π—Ç–∏</button>
                        </div>
                    `;
                }
            } else {
                document.getElementById('authSection').innerHTML = `
                    <button class="login-button" onclick="handleAuthClick()" id="loginButton">–í–æ–π—Ç–∏</button>
                `;
            }
        }

        // === –§–£–ù–ö–¶–ò–ò –î–õ–Ø –°–¢–†–ê–ù–ò–¶ ===
        function showMainPage() {
            window.location.href = 'https://deyniik.github.io/minecraft-wiki/';
        }

        function showMapsPage() {
            window.location.href = 'https://deyniik.github.io/minecraft-wiki/maps';
        }

        function hideLoader() {
            document.getElementById('loadingContent').style.display = 'none';
            document.getElementById('tildaFrame').style.display = 'block';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            updateUI(); // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        };
    </script>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Google API -->
    <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
    <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
</body>
</html>
